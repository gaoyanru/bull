<div class="statis-orders o-list">
  <h2>外勤情况统计</h2>
  <div class="table-container">
    <div class="well well-sm u-search">
      <form class="form-inline">
        <div class="form-group">
          <div class="input-group">
            <input type="text" class="form-control" uib-datepicker-popup ng-model="startdate" is-open="dateIsOpenedS" datepicker-options="dateOptions1" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedS = !dateIsOpenedS" ng-change="startChange()" />
            <span class="input-group-btn">
              <button type="button" class="btn btn-default"  ng-click="dateIsOpenedS = !dateIsOpenedS"><i class="glyphicon glyphicon-calendar"></i></button>
            </span>
          </div> —
        </div>
        <div class="form-group">
          <div class="input-group">
            <input class="form-control" type="text" uib-datepicker-popup ng-model="enddate" is-open="dateIsOpenedE" datepicker-options="dateOptions2" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedE = !dateIsOpenedE" />
            <span class="input-group-btn">
              <button type="button" class="btn btn-default"  ng-click="dateIsOpenedE = !dateIsOpenedE"><i class="glyphicon glyphicon-calendar"></i></button>
            </span>
          </div>
        </div>
        <div class="form-group">
          <span>代理商状态</span>
          <select class="form-control" ng-model="params.status">
              <option value="">全部</option>
              <option value="0">解约</option>
              <option value="1">正常</option>
          </select>
        </div>
        <button type="button" class="btn btn-primary" ng-click="search()">查询</button>
        <button type="button" class="btn btn-primary" ng-click="toExcel()">导出</button>
      </form>
    </div>
    <div style="overflow: auto;" js-height>
      <table class="table table-striped table-hover table-bordered" id="dataTable">
          <thead fix-head>
              <tr class="info">
                <th>省</th>
                <th>市</th>
                <th>一级代理商</th>
                <th>二级代理商</th>
                <th>代理商状态</th>
                <th>预提单数</th>
                <th>外勤总任务数量</th>
                <th>总任务待分配</th>
                <th>总任务待处理</th>
                <th>总任务进行中</th>
                <th>总任务已完成</th>
                <th>总任务已取消</th>
                <th>子任务总数量</th>
                <th>子任务待分配</th>
                <th>子任务待处理</th>
                <th>子任务进行中</th>
                <th>子任务已完成</th>
                <th>子任务已取消</th>
              </tr>
              <tr>
                <th colspan="5">合计</th>
                <th class="text-right">{{aordernum}}</th>
                <th class="text-right">{{aallmainnum}}</th>
                <th class="text-right">{{amainnum1}}</th>
                <th class="text-right">{{amainnum2}}</th>
                <th class="text-right">{{amainnum3}}</th>
                <th class="text-right">{{amainnum4}}</th>
                <th class="text-right">{{amainnum5}}</th>
                <th class="text-right">{{aallchildnum}}</th>
                <th class="text-right">{{achildnum1}}</th>
                <th class="text-right">{{achildnum2}}</th>
                <th class="text-right">{{achildnum3}}</th>
                <th class="text-right">{{achildnum4}}</th>
                <th class="text-right">{{achildnum5}}</th>
              </tr>
          </thead>
          <tbody>
            <tr ng-repeat="item in tableData">
              <td style="text-align:center; width:200px">{{item.ProvinceName}}</td>
              <td style="text-align:center; width:120px">{{item.CityName}}</td>
              <td style="text-align:center; width:120px">{{item.ChannelName1}}</td>
              <td style="text-align:center; width:120px">{{item.ChannelName2}}</td>
              <td style="text-align:center; width:120px">{{item.Status | filterStatus}}</td>
              <td style="text-align:center; width:200px">{{item.ordernum}}</td>
              <td style="text-align:center; width:120px; text-decoration: underline; color: blue;" ng-click="downloadColumn1(item)">{{item.allmainnum}}</td>
              <td style="text-align:center; width:120px">{{item.mainnum1}}</td>
              <td style="text-align:center; width:120px">{{item.mainnum2}}</td>
              <td style="text-align:center; width:120px;">{{item.mainnum3}}</td>
              <td style="text-align:center; width:200px">{{item.mainnum4}}</td>
              <td style="text-align:center; width:120px">{{item.mainnum5}}</td>
              <td style="text-align:center; width:120px; text-decoration: underline; color: blue;" ng-click="downloadColumn2(item)">{{item.allchildnum}}</td>
              <td style="text-align:center; width:100px;">{{item.childnum1}}</td>
              <td style="text-align:center; width:120px">{{item.childnum2}}</td>
              <td style="text-align:center; width:120px">{{item.childnum3}}</td>
              <td style="text-align:center; width:120px">{{item.childnum4}}</td>
              <td style="text-align:center; width:120px">{{item.childnum5}}</td>
            </tr>
          </tbody>
      </table>
    </div>
  </div>
</div>
